<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  install pypy
  #


wget 
  https://bitbucket.org/squeaky/portable-pypy/downloads/pypy-2.3.1-linux_x86_64-portable.tar.bz2
bunzip2 pypy-2.3.1-linux_x86_64-portable.tar.bz2
tar -xvf pypy-2.3.1-linux_x86_64-portable.tar
mv pypy3-2.3.1-linux_x86_64-portable pypy-2.3.1
ln -s pypy-2.3.1/bin/pypy /usr/bin/pypy


  install system enviaronment
  #


yum install &ndash;enablerepo=epel libev.x86_64
yum install &ndash;enablerepo=epel libev-devel.x86_64


must add &ndash;enablerepo=epel when install libev on amazon ec2，because there is not libev source in ec2&rsquo;s yum.
if the libev can not install. you can make it by yourself.

  install system enviaronment by yourself
  #


wget 
  http://dist.schmorp.de/libev/libev-4.15.tar.gz
tar -xvf libev-4.15.tar.gz
cd libev-4.15
./configuration
make
make install


  creat the pypy virtual enviaronment for development
  #


cd pypy-2.3.1
bin/virtualenv-pypy ~/PypyEnv
cd ~/PypyEnv
source bin/activate
pip install gevent
pip install git&#43;git://github.com/schmir/gevent@pypy-hacks
pip install cffi
pip install git&#43;git://github.com/gevent-on-pypy/pypycore
export GEVENT_LOOP=pypycore.loop


If setup.py complains it can not locate ev.h it&rsquo;s possible the library search path isn&rsquo;t complete.  In that case add the directory containing ev.h to the include_dirs variable in pypycore.py (line 215).">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="/posts/gevent-on-pypy/">
  <meta property="og:site_name" content="一哥黑板报">
  <meta property="og:title" content="pypy环境的gevent开发">
  <meta property="og:description" content="install pypy # wget https://bitbucket.org/squeaky/portable-pypy/downloads/pypy-2.3.1-linux_x86_64-portable.tar.bz2 bunzip2 pypy-2.3.1-linux_x86_64-portable.tar.bz2 tar -xvf pypy-2.3.1-linux_x86_64-portable.tar mv pypy3-2.3.1-linux_x86_64-portable pypy-2.3.1 ln -s pypy-2.3.1/bin/pypy /usr/bin/pypy install system enviaronment # yum install –enablerepo=epel libev.x86_64 yum install –enablerepo=epel libev-devel.x86_64 must add –enablerepo=epel when install libev on amazon ec2，because there is not libev source in ec2’s yum.
if the libev can not install. you can make it by yourself.
install system enviaronment by yourself # wget http://dist.schmorp.de/libev/libev-4.15.tar.gz tar -xvf libev-4.15.tar.gz cd libev-4.15 ./configuration make make install creat the pypy virtual enviaronment for development # cd pypy-2.3.1 bin/virtualenv-pypy ~/PypyEnv cd ~/PypyEnv source bin/activate pip install gevent pip install git&#43;git://github.com/schmir/gevent@pypy-hacks pip install cffi pip install git&#43;git://github.com/gevent-on-pypy/pypycore export GEVENT_LOOP=pypycore.loop If setup.py complains it can not locate ev.h it’s possible the library search path isn’t complete. In that case add the directory containing ev.h to the include_dirs variable in pypycore.py (line 215).">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2014-08-20T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-07-17T11:08:50+08:00">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Gevent">
    <meta property="article:tag" content="Pypy">
<title>pypy环境的gevent开发 | 一哥黑板报</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="/posts/gevent-on-pypy/">
<link rel="stylesheet" href="/book.min.e47103a2785905b5db8438d6a609c05371af6c90eabdc369de60b296f8bba830.css" >
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.1b54163ba33699d30ae95ade6aca3c1aab77db8407ee0eb2bed501765f3a8acb.js" ></script>

  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" ></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.jpeg" alt="Logo" class="book-icon" /><span>一哥黑板报</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>























  
<ul>
  
  <li>
    <a href="/posts/"  >
        Blog
      </a>
  </li>
  
  <li>
    <a href="https://github.com/RyanPoy/"  target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>pypy环境的gevent开发</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#install-pypy">install pypy</a></li>
        <li><a href="#install-system-enviaronment">install system enviaronment</a></li>
        <li><a href="#install-system-enviaronment-by-yourself">install system enviaronment by yourself</a></li>
        <li><a href="#creat-the-pypy-virtual-enviaronment-for-development">creat the pypy virtual enviaronment for development</a></li>
        <li><a href="#some-anontations">some anontations</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown book-post">
  <h1>
    pypy环境的gevent开发
  </h1>
  
  <div class="flex align-center text-small book-post-date">
    <img src="/svg/calendar.svg" class="book-icon " alt="" />
    <span>August 20, 2014</span>
  </div>



  
  <div class="text-small">
    
      <a href="/categories/Tech/">Tech</a>
  </div>
  

  
  <div class="text-small">
    
      <a href="/tags/Python/">Python</a>, 
      <a href="/tags/Gevent/">Gevent</a>, 
      <a href="/tags/Pypy/">Pypy</a>
  </div>
  


  <div class="book-post-content"><h2 id="install-pypy">
  install pypy
  <a class="anchor" href="#install-pypy">#</a>
</h2>
<ul>
<li>wget 
  <a href="https://bitbucket.org/squeaky/portable-pypy/downloads/pypy-2.3.1-linux_x86_64-portable.tar.bz2">https://bitbucket.org/squeaky/portable-pypy/downloads/pypy-2.3.1-linux_x86_64-portable.tar.bz2</a></li>
<li>bunzip2 pypy-2.3.1-linux_x86_64-portable.tar.bz2</li>
<li>tar -xvf pypy-2.3.1-linux_x86_64-portable.tar</li>
<li>mv pypy3-2.3.1-linux_x86_64-portable pypy-2.3.1</li>
<li>ln -s pypy-2.3.1/bin/pypy /usr/bin/pypy</li>
</ul>
<h2 id="install-system-enviaronment">
  install system enviaronment
  <a class="anchor" href="#install-system-enviaronment">#</a>
</h2>
<ul>
<li>yum install &ndash;enablerepo=epel libev.x86_64</li>
<li>yum install &ndash;enablerepo=epel libev-devel.x86_64</li>
</ul>
<blockquote>
<p>must add &ndash;enablerepo=epel when install libev on amazon ec2，because there is not libev source in ec2&rsquo;s yum.</p></blockquote>
<p>if the libev can not install. you can make it by yourself.</p>
<h2 id="install-system-enviaronment-by-yourself">
  install system enviaronment by yourself
  <a class="anchor" href="#install-system-enviaronment-by-yourself">#</a>
</h2>
<ul>
<li>wget 
  <a href="http://dist.schmorp.de/libev/libev-4.15.tar.gz">http://dist.schmorp.de/libev/libev-4.15.tar.gz</a></li>
<li>tar -xvf libev-4.15.tar.gz</li>
<li>cd libev-4.15</li>
<li>./configuration</li>
<li>make</li>
<li>make install</li>
</ul>
<h2 id="creat-the-pypy-virtual-enviaronment-for-development">
  creat the pypy virtual enviaronment for development
  <a class="anchor" href="#creat-the-pypy-virtual-enviaronment-for-development">#</a>
</h2>
<ul>
<li>cd pypy-2.3.1</li>
<li>bin/virtualenv-pypy ~/PypyEnv</li>
<li>cd ~/PypyEnv</li>
<li>source bin/activate</li>
<li>pip install gevent</li>
<li>pip install git+git://github.com/schmir/gevent@pypy-hacks</li>
<li>pip install cffi</li>
<li>pip install git+git://github.com/gevent-on-pypy/pypycore</li>
<li>export GEVENT_LOOP=pypycore.loop</li>
</ul>
<blockquote>
<p>If setup.py complains it can not locate ev.h it&rsquo;s possible the library search path isn&rsquo;t complete.  In that case add the directory containing ev.h to the include_dirs variable in pypycore.py (line 215).</p></blockquote>
<h2 id="some-anontations">
  some anontations
  <a class="anchor" href="#some-anontations">#</a>
</h2>
<ol>
<li>write the gevent code, must write the code in first line.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># coding: utf8</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> gevent
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;__pypy__&#34;</span> <span style="color:#f92672">in</span> sys<span style="color:#f92672">.</span>builtin_module_names:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_reuse</span>(self):
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>_sock<span style="color:#f92672">.</span>_reuse()    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_drop</span>(self):
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>_sock<span style="color:#f92672">.</span>_drop()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  gevent<span style="color:#f92672">.</span>socket<span style="color:#f92672">.</span>socket<span style="color:#f92672">.</span>_reuse <span style="color:#f92672">=</span> _reuse
</span></span><span style="display:flex;"><span>  gevent<span style="color:#f92672">.</span>socket<span style="color:#f92672">.</span>socket<span style="color:#f92672">.</span>_drop <span style="color:#f92672">=</span> _drop
</span></span></code></pre></div><ol start="2">
<li>start the gevent server. must run it:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>export GEVENT_LOOP<span style="color:#f92672">=</span>pypycore<span style="color:#f92672">.</span>loop
</span></span></code></pre></div></div>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">


  <div><a class="flex align-center" href="https://github.com/RyanPoy/blog/commit/c334d3c5d0bd533d52ba845f75a352b9260a21ef" title='Last modified by pengyi | July 17, 2025' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" class="book-icon" alt="" />
      <span>July 17, 2025</span>
    </a>
  </div>




</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#install-pypy">install pypy</a></li>
        <li><a href="#install-system-enviaronment">install system enviaronment</a></li>
        <li><a href="#install-system-enviaronment-by-yourself">install system enviaronment by yourself</a></li>
        <li><a href="#creat-the-pypy-virtual-enviaronment-for-development">creat the pypy virtual enviaronment for development</a></li>
        <li><a href="#some-anontations">some anontations</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












